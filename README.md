DRF Firebase Auth
=================

A Django Rest Framework authentication module to verify JWT tokens generated by
a Firebase application.


Quickstart
----------

1. Install DRF Firebase Auth:

```bash
pip install drf-firebase-auth
```

2. Add it to your Django Rest Framework config `INSTALLED_APPS`:

```python
REST_FRAMEWORK = {
    'DEFAULT_AUTHENTICATION_CLASSES': (
    ...
    'drf_firebase_auth.authentication.FirebaseAuthentication',
    ...
    )
}
```

3. If necessary, modify the settings by adding a `DRF_FIREBASE_AUTH` object
to your Django `settings.py` file:

```python
DRF_FIREBASE_AUTH = {
    ##########
    # Required
    ##########

    # Firebase admin credentials. If set, it is assumed to be a path
    # to the service account JSON file. If unset, credentials will be 
    # drawn from the FIREBASE_CREDS environment variable or, if not
    # unavailable, the Google Cloud Platform environment variables
    'CREDENTIALS': None

    ##########
    # Optional
    ##########

    # The key in the JWT dictionary to match to the appropriate field in
    # the Django user 
    'JWT_LOOKUP_KEY': 'email',
    'USER_LOOKUP_KEY': 'email',

    # You can specify a string with a path to a custom user model. If not
    # set, the configured Django user model will be used
    'USER_MODEL': None,

    # The Authorization header schema preceding the actual token, e.g.
    # Bearer, Token, JWT, etc.
    'AUTH_HEADER_SCHEMA': 'Bearer', # e.g.: Authorization: Bearer {JWT}

    # Whether to block authentication for tokens where the 'email_verified'
    # flag in the JWT token is set to False
    'ALLOW_UNVERIFIED_EMAIL': True,

    # Whether to check, and block authentication for, JWT tokens that have
    # been revoked
    'ALLOW_REVOKED': False,
}
```

4. Setup your Firebase admin credentials. You can obtain these from the
Firebase console in the form of a service account JSON file.

You can either store this file on disk and provide the path in the CREDENTIALS
setting, or alternatively you can base64 encode the JSON file and store it in
the FIREBASE_CREDS environment variable, e.g.:

```bash
$ export FIREBASE_CREDS=$(cat firebase_service_account.json | base64 -w 0)
```

Note that setting the CREDENTIALS variable will take precedence over the
FIREBASE_CREDS environment.
